!function(e){"use strict";e.module("ng-context-menu",[]).directive("contextMenu",["$document",function(n){return{restrict:"A",scope:{callback:"&contextMenu",disabled:"&contextMenuDisabled",closeCallback:"&contextMenuClose",treeNode:"=contextMenuTreeNode",isLumxDropdown:"&"},link:function(t,o,i){function c(){return $(document.getElementById(i.target))}function l(e,n){n||(n=c());var t=e.pageX,o=e.pageY;r(o,t)}function u(e,n){var t=e.getBoundingClientRect(),o=t.right,i=t.top-.5*t.height;n&&"string"==typeof n&&(n.indexOf("bottom")>-1?i=t.bottom:n.indexOf("top")>-1&&(i=t.top),n.indexOf("left")>-1?o=t.left:n.indexOf("right")>-1&&(o=t.right)),r(i,o)}function d(t,o){var i=c();i.addClass("open");var l=n[0].documentElement,u=(window.pageXOffset||l.scrollLeft)-(l.clientLeft||0),d=(window.pageYOffset||l.scrollTop)-(l.clientTop||0),r=i[0].scrollWidth,s=i[0].scrollHeight,a=l.clientWidth+u,p=l.clientHeight+d,f=r+o,b=s+t;if(f>a&&(o=window.innerWidth-i[0].scrollWidth),b>p&&(t=window.innerHeight-i[0].scrollHeight),i.css("top",t+"px"),i.css("left",o+"px"),x=!0,g){var m=e.element(i).scope();m.isOpened=!0}}function r(n,o){var i=c(),l=null;return g&&(l=e.element(i).scope(),l.isOpened)?(l.isOpened=!1,void setTimeout(function(){d(n,o),t.$apply()},350)):void d(n,o)}function s(){x&&t.closeCallback(),x=!1}function a(e){t.disabled()||(s(),e.preventDefault(),e.stopPropagation(),t.$apply(function(){t.callback({$event:e}),l(e)}))}function p(e){!t.disabled()&&x&&27===e.keyCode&&t.$apply(function(){s()})}function f(e){t.disabled()||!x||2===e.button&&e.target===o||t.$apply(function(){s()})}var x=!1,g="true"==i.isLumxDropdown;t.leftClick=i.contextMenuLeftClick,t.treeNode?(t.treeNode.contextMenuFunctions={},t.treeNode.contextMenuFunctions.openOn=u,t.treeNode.contextMenuFunctions.openAt=r,t.treeNode.contextMenuFunctions.close=s):console.warn("no scope.treeNode object");var b=t.leftClick?"click":"contextmenu";o.bind(b,a),n.bind("keyup",p),n.bind("click",f),n.bind("contextmenu",f),t.$on("$destroy",function(){s(),n.unbind("keyup",p),n.unbind("click",f),n.unbind("contextmenu",f)})}}}])}(angular);