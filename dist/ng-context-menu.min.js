!function(e){"use strict";e.module("ng-context-menu",[]).factory("ContextMenuService",function(){return{element:null,menuElement:null}}).directive("contextMenu",["$document","ContextMenuService",function(n,t){return{restrict:"A",scope:{callback:"&contextMenu",disabled:"&contextMenuDisabled",closeCallback:"&contextMenuClose"},link:function(l,c,o){function i(e,t){var l=n[0].documentElement,c=(window.pageXOffset||l.scrollLeft)-(l.clientLeft||0),o=(window.pageYOffset||l.scrollTop)-(l.clientTop||0),i=t[0].scrollWidth,a=t[0].scrollHeight,m=l.clientWidth+c,d=l.clientHeight+o,s=i+e.pageX,r=a+e.pageY,f=Math.max(e.pageX-c,0),p=Math.max(e.pageY-o,0);s>m&&(f-=s-m),r>d&&(p-=r-d),u(p,f,t)}function u(e,n,t){t.addClass("open"),t.css("top",e+"px"),t.css("left",n+"px"),r=!0}function a(e){e&&e.removeClass("open"),r&&l.closeCallback(),r=!1}function m(n){if(!l.disabled()){a(t.menuElement);var c=e.element(document.getElementById(o.target));t.menuElement=c,t.element=n.target,n.preventDefault(),n.stopPropagation(),l.$apply(function(){l.callback({$event:n})}),l.$apply(function(){i(n,t.menuElement)})}}function d(e){!l.disabled()&&r&&27===e.keyCode&&l.$apply(function(){a(t.menuElement)})}function s(e){l.disabled()||!r||2===e.button&&e.target===t.element||l.$apply(function(){a(t.menuElement)})}var r=!1;l.leftClick=o.contextMenuLeftClick;var f="contextmenu";l.leftClick&&(f="click"),c.bind(f,m),n.bind("keyup",d),n.bind("click",s),n.bind("contextmenu",s),l.$on("$destroy",function(){var e=t.menuElement;e&&e.removeClass("open"),n.unbind("keyup",d),n.unbind("click",s),n.unbind("contextmenu",s)})}}}])}(angular);